<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>TikTok HD Video Downloader</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0a0a0a;
      --panel: #111316;
      --panel-2: #0e1013;
      --text: #f5f7fa;
      --muted: #b8c0cc;
      --error: #ff4d4f;
      --ok: #19c37d;
      --border: #1c1f24;
      --accent-cyan: #00f2ea;
      --accent-pink: #ff0050;
      --shadow: 0 8px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --ring: 0 0 0 2px rgba(255,255,255,.04), 0 0 0 8px rgba(255,255,255,.02);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 85% -10%, rgba(255,0,80,.12), transparent 60%),
        radial-gradient(900px 600px at -10% 110%, rgba(0,242,234,.10), transparent 60%),
        var(--bg);
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .app {
      width: 100%;
      max-width: 920px;
      display: grid;
      gap: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
      user-select: none;
    }
    .logo {
      inline-size: 42px;
      block-size: 42px;
      border-radius: 11px;
      background:
        conic-gradient(from 210deg at 70% 30%, var(--accent-pink), transparent 30%),
        conic-gradient(from 30deg at 35% 70%, var(--accent-cyan), transparent 40%),
        linear-gradient(180deg, #0d0f12, #0a0a0a);
      box-shadow: 0 12px 30px rgba(255,0,80,.20), 0 10px 26px rgba(0,242,234,.16), inset 0 0 0 1px #222;
    }
    .title {
      font-weight: 800;
      font-size: 24px;
      letter-spacing: .2px;
    }
    .subtitle {
      font-size: 14px;
      color: var(--muted);
    }

    .card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .input-wrap {
      position: relative;
      display: grid;
    }
    .input {
      width: 100%;
      font-size: 16px;
      padding: 16px 18px;
      border-radius: 12px;
      color: var(--text);
      background: #0c0e12;
      border: 1px solid var(--border);
      outline: none;
      transition: box-shadow .15s, border-color .15s, transform .06s;
    }
    .input:focus {
      border-color: #2a3037;
      box-shadow: var(--ring);
    }
    .helper {
      margin-top: 8px;
      font-size: 13px;
      color: var(--muted);
    }

    .actions {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }

    @media (min-width: 720px) {
      .row { grid-template-columns: 1fr auto; align-items: start; }
      .actions { grid-template-columns: 1fr 1fr; }
    }

    .btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px 16px;
      font-weight: 700;
      border-radius: 12px;
      border: 1px solid var(--border);
      color: var(--text);
      background: #121418;
      cursor: pointer;
      transition: transform .06s ease, box-shadow .15s ease, border-color .15s ease;
      user-select: none;
    }
    .btn:active { transform: translateY(1px); }
    .btn:hover { border-color: #2a3037; }

    .btn.cyan {
      background:
        linear-gradient(180deg, rgba(0,242,234,.22), rgba(0,242,234,.06)),
        #101216;
      box-shadow: 0 6px 18px rgba(0,242,234,.18);
    }
    .btn.pink {
      background:
        linear-gradient(180deg, rgba(255,0,80,.22), rgba(255,0,80,.06)),
        #101216;
      box-shadow: 0 6px 18px rgba(255,0,80,.18);
    }
    .btn[disabled] {
      opacity: .6;
      cursor: not-allowed;
      box-shadow: none;
    }

    .status {
      display: grid;
      gap: 10px;
    }

    .alert {
      display: none;
      padding: 12px 14px;
      border-radius: 12px;
      font-size: 14px;
      border: 1px solid var(--border);
      background: #14171c;
    }
    .alert.show { display: grid; grid-auto-flow: column; align-items: center; justify-content: start; gap: 8px; }
    .alert.error { border-color: rgba(255,77,79,.35); color: #ffd7d7; background: rgba(255,77,79,.08); }
    .alert.ok { border-color: rgba(25,195,125,.35); color: #d9fff0; background: rgba(25,195,125,.08); }

    .result {
      display: none;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px;
      background: #121418;
      gap: 10px;
    }
    .result.show { display: grid; }

    .result .meta {
      font-size: 13px;
      color: var(--muted);
    }
    .result .link {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
    }
    .result .link a {
      color: var(--accent-cyan);
      text-decoration: none;
      word-break: break-all;
    }

    .loader {
      display: none;
      position: relative;
      place-items: center;
      padding: 16px;
    }
    .loader.show { display: grid; }

    .spinner {
      inline-size: 28px;
      block-size: 28px;
      border-radius: 50%;
      border: 3px solid rgba(255,255,255,.12);
      border-top-color: var(--accent-cyan);
      border-right-color: var(--accent-pink);
      animation: spin 1.0s linear infinite;
      filter: drop-shadow(0 0 12px rgba(0,242,234,.35));
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .accent-bar {
      height: 3px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent-pink), var(--accent-cyan));
      opacity: .8;
    }

    .footer {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      color: var(--muted);
      font-size: 12px;
      gap: 8px;
    }
    .note { color: var(--muted); }
    .kbd {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: #0e1013;
      font-size: 11px;
    }
  </style>
</head>

<body>
  <main class="app">
    <section class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">TikTok HD Video Downloader</div>
        <div class="subtitle">Tempel link video TikTok, lalu pilih opsi download</div>
      </div>
    </section>

    <div class="accent-bar" aria-hidden="true"></div>

    <section class="card">
      <div class="row">
        <div class="input-wrap">
          <input id="url" class="input" type="text" inputmode="url" autocomplete="off"
                 placeholder="https://www.tiktok.com/@username/video/1234567890"
                 aria-label="Link video TikTok" />
          <div class="helper">Dukung link seperti <span class="kbd">tiktok.com/@.../video/...</span>, <span class="kbd">vm.tiktok.com/...</span>, atau <span class="kbd">vt.tiktok.com/...</span></div>
        </div>

        <div class="actions">
          <button id="btn-hd" class="btn cyan">Download Tanpa Watermark (HD)</button>
          <button id="btn-wm" class="btn pink">Download Dengan Watermark</button>
        </div>
      </div>

      <div class="status">
        <div id="alert" class="alert" role="alert"></div>

        <div id="loader" class="loader" aria-live="polite" aria-busy="true">
          <div class="spinner" aria-label="Memuat"></div>
        </div>

        <div id="result" class="result">
          <div class="meta">Download siap:</div>
          <div class="link">
            <a id="download-url" href="#" target="_blank" rel="noopener">Link akan muncul di sini</a>
            <a id="download-btn" class="btn" href="#" download>Save Video</a>
          </div>
        </div>
      </div>
    </section>

    <section class="footer">
      <span class="note">Gunakan secara bertanggung jawab. Hormati hak cipta dan ketentuan TikTok.</span>
      <span class="kbd">Enter</span> untuk submit cepat
    </section>
  </main>

  <script>
    const $ = sel => document.querySelector(sel);
    const input = $('#url');
    const btnHD = $('#btn-hd');
    const btnWM = $('#btn-wm');
    const alertBox = $('#alert');
    const loader = $('#loader');
    const resultBox = $('#result');
    const linkEl = $('#download-url');
    const saveBtn = $('#download-btn');

    function showAlert(message, type = 'error') {
      alertBox.textContent = message;
      alertBox.className = `alert show ${type === 'ok' ? 'ok' : 'error'}`;
    }
    function clearAlert() {
      alertBox.textContent = '';
      alertBox.className = 'alert';
    }
    function setLoading(loading) {
      loader.className = loading ? 'loader show' : 'loader';
      btnHD.disabled = loading;
      btnWM.disabled = loading;
      input.disabled = loading;
    }
    function setResult(url, filename) {
      if (url) {
        linkEl.href = url;
        linkEl.textContent = url;
        saveBtn.href = url;
        if (filename) saveBtn.setAttribute('download', filename);
        resultBox.className = 'result show';
      } else {
        resultBox.className = 'result';
      }
    }

    function normalizeUrl(u) {
      const v = String(u || '').trim();
      if (!v) return '';
      if (!/^https?:\/\//i.test(v)) return 'https://' + v;
      return v;
    }

    function isValidTikTokUrl(u) {
      try {
        const url = new URL(normalizeUrl(u));
        const host = url.hostname.toLowerCase();

        if (!host.includes('tiktok.com')) return false;

        const patterns = [
          /^\/@[\w\.\-]+\/video\/\d+\/?$/i,
          /^\/t\/[\w\-]+\/?$/i,
          /^\/[\w\-]+\/?$/i
        ];
        return patterns.some(rx => rx.test(url.pathname));
      } catch {
        return false;
      }
    }

    async function requestDownload(originalUrl, withWatermark) {
      clearAlert();
      setResult('', '');
      setLoading(true);

      try {
        const url = normalizeUrl(originalUrl);
        if (!isValidTikTokUrl(url)) {
          throw new Error('Link TikTok tidak valid. Periksa formatnya.');
        }

        const payload = {
          url,
          watermark: withWatermark ? 'with' : 'without',
          quality: 'hd'
        };

        const headers = {
          'Content-Type': 'application/json'
        };

        const API_URL = ''; // PLACEHOLDER API

        let data;
        if (API_URL) {
          const resp = await fetch(API_URL, { method: 'POST', headers, body: JSON.stringify(payload) });
          if (!resp.ok) throw new Error('Gagal memproses download. Coba lagi.');
          data = await resp.json();
        } else {
          await new Promise(r => setTimeout(r, 1400));
          const suffix = withWatermark ? 'wm' : 'hd';
          data = {
            success: true,
            downloadUrl: `https://example.com/tiktok-video-${suffix}.mp4`,
            filename: `tiktok-${Date.now()}-${suffix}.mp4`
          };
        }

        if (!data || !data.downloadUrl) {
          throw new Error('Tidak menerima link download dari layanan.');
        }

        setResult(data.downloadUrl, data.filename || '');
        showAlert('Download siap. Klik Save Video untuk menyimpan.', 'ok');
      } catch (err) {
        showAlert(err.message || 'Terjadi kesalahan tak terduga.', 'error');
      } finally {
        setLoading(false);
      }
    }

    btnHD.addEventListener('click', () => requestDownload(input.value, false));
    btnWM.addEventListener('click', () => requestDownload(input.value, true));

    input.addEventListener('keydown', e => {
      if (e.key === 'Enter') requestDownload(input.value, false);
    });
  </script>
</body>
</html>
